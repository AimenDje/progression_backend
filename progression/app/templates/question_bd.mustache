<head>

    <link rel='stylesheet' type='text/css' href='css/style.css'>
    <script src='./CodeMirror/lib/codemirror.js'></script>
    <link rel='stylesheet' href='./CodeMirror/lib/codemirror.css'>

    <script src='./CodeMirror/mode/{{mode}}'></script>

    <meta charset='utf-8'>
</head>
<body>
    <section class='main'>
        <div class='example-wrapper clearfix'>
            <h3>{{titre}}</h3>
            <br>
            {{{énoncé}}}
            <br>
            <br>
            {{#essayé}}   
            <table class='metro' width=100%><tr>
	                {{#réussi}}
                            <td width=50% align=center>
                                Bonne réponse!
                            </td>
	                    {{#validation}}
                                <td>
                                    Code de validation : {{validation}}
                                </td>
	                    {{/validation}}
	                {{/réussi}}
	                {{#nonréussi}}    
                            <td width=50% align=center>
                                Raté! Essayez encore
                            </td>
	                {{/nonréussi}}
            </tr></table>
	    {{/essayé}}
            <pre class='code-wrapper'>
                <code>
                    <form method='post' action=''>
                        <table width=100% style='background-color: white; border-style:solid; border-color:black; border-width:0px; border-spacing: 10px 10px;'>
                            <tr>
                                <td>
                                    Langage : {{lang_nom}}
                            </tr>
                            <tr {{^pre_code}} style="display:none;" {{/pre_code}}>
                                <td colspan=2>
                                    <textarea id='precode' rows='5' >{{pre_code}}</textarea>
                                </td>
                            </tr>

	                    <tr>
                                <td colspan=2>
                                    <textarea id='incode' name = 'incode' rows='10' cols='80'>{{code}}</textarea>
                                </td>
	                    </tr>  

                            <tr {{^post_code}} style="display:none;" {{/post_code}}>
                                <td colspan=2>
                                    <textarea id='postcode' rows='5' >{{post_code}}</textarea>
                                </td>
                            </tr>
	                    <tr>
                                <td>
                                {{#question.répondable}}
                                    <input type=submit name='submit' value='Exécuter' >
                                {{/question.répondable}}
                                {{^question.répondable}}
                                    <input type=submit name='submit' value='Soumettre' >
                                {{/question.répondable}}
                                </td>
                            </tr>
                            <tr>
		                <td>
		                    {{#question.répondable}}
		                        Réponse: <input type=text name='reponse' value='{{avancement.reponse}}'>
		                        <input type=submit name='submit' value='Soumettre'>
		                    {{/question.répondable}}
		                </td>
		                <td  align=right>
		                    <input type=submit name='reset' value='Réinitialiser' onclick='return confirm("Voulez-vous vraiment réinitialiser votre session?");'>
		                </td>
	                    </tr>
	                    <tr height=100%></tr> <!-- comble l'espace inutilisé dans la table -->

                        </table>
                    </form>
                </code>
            </pre>  
		<table width=100%>
                {{#essayé}}
                    {{#erreurs}}
	                <tr>
                            <td colspan=2><br>Sortie d'erreur : <br><pre class='code-wrapper'><code>{{erreurs}}</code></pre><br></td>
                        </tr>
	                <tr>
                    {{/erreurs}}
                {{/essayé}}
                <td witdh=100% valign=top><br>Sortie attendue : <br><pre class='code-wrapper'><code>{{solution}}</code></pre><br>
                    <td width=50%  valign=top><br>Sortie standard : <br><pre class='code-wrapper'><code>{{output}}</code></pre><br></td>
                        </tr>
            </table>
            <table width=100%>
                <tr>
                    <td align=left width=25%>
                        <a href={{{url_retour}}}>↩ Retour à {{titre_retour}}</a>
                    </td>
                    <td align=right width=25%>
	                {{#état_réussi}}
	                    {{#suivante}}
                                <a href=index.php?p=question_bd&ID={{.}}>Question suivante →</a>
	                    {{/suivante}}
	                {{/état_réussi}}
                    </td>
                </tr>
		</table>
            <script>
             function betterTab(cm) {                         
                 if (cm.somethingSelected()) {
                     cm.indentSelection('add');
                 } else {
                     cm.replaceSelection(cm.getOption('indentWithTabs')? '\t':
                                         Array(cm.getOption('indentUnit') + 1).join(' '), 'end', '+input');
                 }
	     }

             var preeditor = CodeMirror.fromTextArea(document.getElementById('precode'),{
                 readOnly: true,
                 lineNumbers: true,
                 //firstLineNumber: {{première_ligne_éditeur_precode}},
                 indentUnit: 4
             });
             preeditor.setSize(null,'100%');//preeditor.getScrollInfo().height);
	     
             var editor = CodeMirror.fromTextArea(document.getElementById('incode'),{
                 matchBrackets: true,
                 lineNumbers: true,
                 //firstLineNumber: {{première_ligne_éditeur_incode}},
                 readOnly: false,
                 indentUnit: 4,
                 scrollbarStyle: null,
                 extraKeys: { Tab: betterTab }
             });
             editor.setSize('100%', '100%');

             var posteditor = CodeMirror.fromTextArea(document.getElementById('postcode'),{
                 readOnly: true,
                 lineNumbers: true,
                 //firstLineNumber: {{première_ligne_éditeur_incode}}+editor.doc.lineCount(),
                 indentUnit: 4
             });
             posteditor.setSize(null,'100%');
             editor.doc.on('change', function(instance, changeObj){
                 posteditor.setOption('firstLineNumber', {{première_ligne_éditeur_incode}}+editor.doc.lineCount());
             });

            </script>
    </div>
  </section>
  {{>footer}}
